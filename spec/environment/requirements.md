# 環境設定機能 要件仕様書

**作成日**: 2025-07-23
**最終更新**: 2025-07-23
**ステータス**: Draft

## 機能概要

開発環境の基礎となるシェル環境、設定ファイル、SSH設定、macOSシステム設定を統合的に管理し、一貫性のある開発環境を構築する。既存の設定を尊重しながら、開発者向けの最適化を提供する。

## ユーザーストーリー

### US-ENV-001: Oh My Zshのセットアップ
**As a** コマンドライン開発者
**I want** モダンなシェル環境を構築する
**So that** 効率的なコマンドライン作業ができる

**受け入れ基準:**
- GIVEN 環境設定メニュー
- WHEN Oh My Zshセットアップを選択
- THEN Oh My Zshがインストールされる
- AND Powerlevel10kテーマが設定される
- AND 便利なプラグインが有効化される
- AND 既存の.zshrcがバックアップされる

### US-ENV-002: 設定ファイルの管理
**As a** 開発者
**I want** 基本的な設定ファイルを自動生成する
**So that** 統一された開発環境を構築できる

**受け入れ基準:**
- GIVEN 環境設定メニュー
- WHEN 基本設定ファイル作成を選択
- THEN .zshrc、.gitconfig等が生成される
- AND 既存ファイルはバックアップされる
- AND カスタマイズ可能な形式で作成される

### US-ENV-003: SSH鍵の管理
**As a** リモート作業をする開発者
**I want** SSH鍵を安全に生成・管理する
**So that** セキュアなリモート接続ができる

**受け入れ基準:**
- GIVEN 環境設定メニュー
- WHEN SSH鍵生成を選択
- THEN Ed25519形式の鍵が生成される
- AND 適切な権限が設定される
- AND ssh-agentに自動追加される
- AND GitHub等への登録方法が案内される

### US-ENV-004: macOS最適化
**As a** Mac開発者
**I want** macOSを開発向けに最適化する
**So that** 開発作業に集中できる環境を構築できる

**受け入れ基準:**
- GIVEN 環境設定メニュー
- WHEN macOS設定最適化を選択
- THEN 開発向け設定が適用される
- AND 設定変更前に確認が求められる
- AND 変更内容が明確に説明される

### US-ENV-005: 統合環境構築
**As a** 新規環境を構築する開発者
**I want** すべての環境設定を一括適用する
**So that** 完全な開発環境を素早く構築できる

**受け入れ基準:**
- GIVEN 環境設定メニュー
- WHEN すべての設定を適用を選択
- THEN 全設定が順次適用される
- AND 各ステップの進捗が表示される
- AND エラー時も継続可能

## 機能仕様

### Oh My Zsh環境

1. **基本インストール**
   - Oh My Zsh本体
   - Powerlevel10kテーマ
   - フォントのインストール案内

2. **プラグイン**
   - git - Git統合
   - zsh-autosuggestions - コマンド補完
   - zsh-syntax-highlighting - シンタックスハイライト
   - history-substring-search - 履歴検索
   - docker - Docker補完
   - kubectl - Kubernetes補完

3. **カスタマイズ**
   - テーマ設定
   - プロンプトカスタマイズ
   - エイリアス定義

### 設定ファイル

1. **.zshrc**
   - PATH設定
   - エイリアス定義
   - 環境変数
   - プラグイン設定

2. **.gitconfig**
   - ユーザー情報
   - エディタ設定
   - エイリアス
   - デフォルトブランチ

3. **.ssh/config**
   - 基本設定テンプレート
   - ホスト別設定例
   - セキュリティ設定

4. **その他**
   - .vimrc基本設定
   - .tmux.conf
   - .editorconfig

### SSH設定

1. **鍵生成**
   - Ed25519（推奨）
   - RSA 4096bit（互換性）
   - パスフレーズオプション

2. **鍵管理**
   - ssh-agent自動起動
   - キーチェーン統合
   - 複数鍵の管理

3. **セキュリティ**
   - 適切な権限設定
   - known_hosts管理
   - SSH設定の強化

### macOS最適化

1. **システム設定**
   - スリープ設定
   - 省エネルギー設定
   - スクリーンセーバー

2. **開発者設定**
   - 隠しファイル表示
   - ファイル拡張子表示
   - フルパス表示

3. **パフォーマンス**
   - アニメーション軽減
   - 透明効果の調整
   - インデックス最適化

## 非機能要件

### セキュリティ要件
- SSH鍵の安全な生成と保管
- 設定ファイルの適切な権限
- 機密情報の非表示化
- バックアップの暗号化オプション

### 可用性要件
- 既存設定の保護
- ロールバック機能
- 部分的な適用
- 設定の検証

### 互換性要件
- zsh/bash両対応
- macOS Big Sur以降
- 既存ツールとの共存
- dotfiles管理ツールとの互換性

### パフォーマンス要件
- シェル起動時間の最適化
- 設定適用は5分以内
- 最小限のシステムリソース使用

## 依存関係

### 前提条件
- 基本セットアップ完了
- zshがデフォルトシェル
- Git設定済み

### 影響範囲
- すべてのシェルセッション
- Git操作
- SSH接続
- システム全体の動作

## 制約事項

1. **既存設定との競合**
   - カスタム設定の上書き
   - dotfiles管理との整合性
   - チーム設定との互換性

2. **システム制限**
   - SIP制限下での動作
   - 管理者権限の必要性
   - iCloud同期との関係

3. **カスタマイズの限界**
   - 個人設定の多様性
   - 企業ポリシーの考慮
   - 国際化対応

## 検証基準

### 設定確認コマンド
```bash
# Oh My Zsh
echo $ZSH_THEME
echo $plugins

# Git設定
git config --list

# SSH設定
ssh-add -l

# macOS設定
defaults read
```

### 動作確認
- シェルの起動速度
- コマンド補完の動作
- Git操作の正常性
- SSH接続の成功